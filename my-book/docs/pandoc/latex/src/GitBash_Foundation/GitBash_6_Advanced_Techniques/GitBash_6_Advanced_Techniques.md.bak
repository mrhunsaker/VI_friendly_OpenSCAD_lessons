# GitBash-6: Advanced Terminal Techniques - Shell Scripts, Functions & Professional Workflows

**Duration:** 4-4.5 hours (for screen reader users)
**Prerequisites:** Complete GitBash-0 through GitBash-5
**Skill Level:** Advanced intermediate

This lesson extends Git Bash skills to professional-level workflows. You'll learn to automate complex tasks, write reusable shell scripts, and integrate tools for 3D printing workflows.

---

## Learning Objectives

By the end of this lesson, you will be able to:

- Create and run shell scripts (.sh files)
- Write functions that accept parameters
- Use loops to repeat tasks automatically
- Automate batch processing of 3D models
- Debug scripts when something goes wrong
- Create professional workflows combining multiple tools

---

## Shell Script Basics

### What's a Shell Script?

A shell script (`.sh`) contains multiple bash commands that run in sequence. Instead of typing commands one by one, you put them in a file and run them all at once.

**Why use shell scripts?**
- Repeatability: Run the same task 100 times identically
- Documentation: Commands are written down for reference
- Complexity: Combine many commands logically
- Automation: Schedule scripts to run automatically

### Creating Your First Shell Script

**Step 1: Open a text editor**
```bash
notepad.exe my-first-script.sh
```

**Step 2: Type this script**
```bash
#!/bin/bash
# This is a comment - screen readers will read it
echo "Script is running!"
pwd
ls -1
echo "Script is done!"
```

**Step 3: Save the file**
- In Notepad: Ctrl+S
- Make sure filename ends in `.sh`
- Save in an easy-to-find location (like Documents)

**Step 4: Make it executable and run the script**
```bash
chmod +x my-first-script.sh
./my-first-script.sh
```

**What happens:**
Bash runs each command in sequence and shows output.

### Important: The Shebang Line

The `#!/bin/bash` at the top of your script (called a "shebang") tells the system which shell to use to run the script.

```bash
#!/bin/bash
# Now bash runs every command below
echo "Hello!"
```

---

## Variables and Parameters

### Using Variables

Variables store values you want to use later.

**Example script:**
```bash
#!/bin/bash
mypath="$HOME/Documents"
cd "$mypath"
echo "I am now in:"
pwd
ls -1
```

**Breaking it down:**
- `mypath="..."` assigns the variable (no spaces around `=`)
- `"$mypath"` uses the variable (quote it to handle spaces in paths)
- Variables in bash are always referenced with `$`

### Functions with Parameters

A function is reusable code that you can run with different inputs.

**Example: A function that lists files in a folder**

```bash
#!/bin/bash
list_folder() {
    local path="$1"
    echo "Contents of: $path"
    cd "$path"
    ls -1
}

# Use the function:
list_folder "$HOME/Documents"
list_folder "$HOME/Downloads"
```

**What's happening:**
- `list_folder()` defines the function
- `local path="$1"` assigns the first argument to a local variable
- `$1` is the first argument passed to the function
- Call the function with `list_folder "path/to/folder"`

**Screen reader tip:** When you call a function, bash will announce the results just like any command.

---

## Loops - Repeating Tasks

### Loop Over Files

Imagine you have 10 SCAD files and want to print their contents. You could do it 10 times manually, or use a loop.

**Example: Print every .scad file in a folder**

```bash
#!/bin/bash
for file in *.scad; do
    echo "=== File: $file ==="
    cat "$file"
    echo ""
done
```

**What's happening:**
- `for file in *.scad; do` iterates over each `.scad` file
- `$file` holds the current filename
- `done` ends the loop
- Inside the loop, do something with each `$file`

### Loop with a Counter

**Example: Do something 5 times**

```bash
#!/bin/bash
for i in $(seq 1 5); do
    echo "This is iteration number $i"
    # Do something here
done
```

**What's happening:**
- `for i in $(seq 1 5)` loops with `i` from 1 to 5
- `$i` is the counter variable

---

## Real-World Example - Batch Processing SCAD Files

### Scenario

You have 10 OpenSCAD (.scad) files in a folder. You want to:
1. List them all
2. Check how many there are
3. For each one, verify it exists

### The Script

```bash
#!/bin/bash
scad_folder="$HOME/Documents/3D_Projects"
count=0

echo "Processing SCAD files in: $scad_folder"
echo ""

for file in "$scad_folder"/*.scad; do
    if [ -f "$file" ]; then
        echo "  Found: $(basename "$file")"
        count=$((count + 1))
    else
        echo "  Missing: $(basename "$file")"
    fi
done

echo ""
echo "Total files found: $count"
echo "Batch processing complete!"
```

**Breaking it down:**
- `scad_folder="..."` = where to look
- `for file in "$scad_folder"/*.scad` = find all .scad files
- `if [ -f "$file" ]` = check if file exists and is a regular file
- `basename "$file"` = just the filename (not the full path)
- `count=$((count + 1))` = increment the counter

### Running the Script

1. Save as `batch-process.sh`
2. Edit `scad_folder` to match your real folder
3. Make it executable and run it:
   ```bash
   chmod +x batch-process.sh
   ./batch-process.sh
   ```

**Screen reader output:**
```
Processing SCAD files in: /c/Users/YourName/Documents/3D_Projects

  Found: model1.scad
  Found: model2.scad
  Found: model3.scad
[... more files ...]

Total files found: 10
Batch processing complete!
```

---

## Error Handling

### Try-Style Checks with Exit Codes

What if something goes wrong? Use exit code checks:

**Example:**
```bash
#!/bin/bash
file="$HOME/nonexistent/path/file.txt"

if cat "$file" 2>/dev/null; then
    echo "File read successfully"
else
    echo "Error: Could not read file"
    echo "File path was: $file"
fi
```

**What's happening:**
- `2>/dev/null` suppresses error messages from `cat`
- `if cat ...; then` checks whether the command succeeded
- `else` handles the failure gracefully

**Screen reader advantage:** Errors are announced clearly instead of crashing silently.

### Validating Input

**Example: Make sure a folder exists before processing**

```bash
#!/bin/bash
process_folder() {
    local folder_path="$1"

    if [ ! -d "$folder_path" ]; then
        echo "Error: Folder does not exist: $folder_path"
        return 1
    fi

    echo "Processing folder: $folder_path"
    ls -1 "$folder_path"
}

process_folder "$HOME/Documents"
```

**What's happening:**
- `[ ! -d "$folder_path" ]` checks if the path is NOT a directory
- `return 1` exits the function early with a non-zero (error) status

---

## Debugging Shell Scripts

### Common Errors and Solutions

#### Error 1: "Command not found"

**Cause:** Typo in command name

**Fix:** Check spelling
```bash
# Wrong:
ech "hello"

# Correct:
echo "hello"
```

#### Error 2: "Variable is empty"

**Cause:** Variable was never assigned or has a typo

**Fix:** Make sure variable is set before using it
```bash
myvar="hello"  # Set first
echo "$myvar"  # Then use
```

#### Error 3: "No such file or directory"

**Cause:** Wrong folder path

**Fix:** Verify path exists
```bash
# Check if path exists:
if [ -d "$HOME/Documents" ]; then
    echo "Path exists"
fi
```

#### Error 4: "Permission denied"

**Cause:** Script not executable, or no write permission

**Fix:** Make the script executable, or check file permissions
```bash
chmod +x my-script.sh
```

### Debugging Technique: Trace Output with `set -x`

Add `set -x` at the top of your script to print each command before it runs:

```bash
#!/bin/bash
set -x  # Enable trace mode
path_var="$HOME/Documents"
echo "Starting script. Path is: $path_var"

for file in "$path_var"/*; do
    echo "Processing: $file"
    # Do something with $file
    echo "Done with: $file"
done

echo "Script complete"
```

Your screen reader will announce each step, so you know where errors happen.

---

## Creating Professional Workflows

### Example 1: Automated Project Setup

**Scenario:** You start a new 3D printing project regularly. Instead of creating folders manually:

```bash
#!/bin/bash
read -p "Enter project name: " project_name
base_folder="$HOME/Documents/3D_Projects"
project_folder="$base_folder/$project_name"

# Create folder structure
mkdir -p "$project_folder"
mkdir -p "$project_folder/designs"
mkdir -p "$project_folder/output"
mkdir -p "$project_folder/notes"

# Create a README
cat > "$project_folder/README.txt" << EOF
# $project_name

Created: $(date)

## Designs
All .scad files go here.

## Output
STL and other exports go here.

## Notes
Project notes and observations.
EOF

echo "Project setup complete: $project_folder"
```

**What it does:**
- Prompts for a project name
- Creates folder structure for a new project
- Sets up subfolders for designs, output, notes
- Creates a README file automatically

### Example 2: Batch File Verification

**Scenario:** Before processing, verify all required files exist:

```bash
#!/bin/bash
verify_project() {
    local project_folder="$1"
    local required_items=("README.txt" "designs" "output" "notes")
    local all_good=true

    for item in "${required_items[@]}"; do
        local path="$project_folder/$item"
        if [ -e "$path" ]; then
            echo "  Found: $item"
        else
            echo "  Missing: $item"
            all_good=false
        fi
    done

    if $all_good; then
        echo "All checks passed!"
        return 0
    else
        echo "Some files are missing!"
        return 1
    fi
}

# Use it:
project="$HOME/Documents/3D_Projects/MyKeychain"
if verify_project "$project"; then
    echo "Safe to proceed with processing"
fi
```

---

## Screen Reader Tips for Shell Scripts

### Making Script Output Readable

**Problem:** Script runs but output scrolls too fast or is hard to follow

**Solution 1: Save to file**
```bash
./my-script.sh > output.txt
notepad.exe output.txt
```

**Solution 2: Use echo with clear sections**
```bash
echo "========== STARTING =========="
echo ""
# ... script ...
echo ""
echo "========== COMPLETE =========="
```

**Solution 3: Pause between major sections**
```bash
echo "Pausing... Press Enter to continue"
read
```

Your screen reader will announce the pause, give you time to read output.

### Announcing Progress

**For long-running scripts:**
```bash
#!/bin/bash
count=0
total=$(ls *.scad | wc -l)

for file in *.scad; do
    count=$((count + 1))
    echo "Processing $count of $total: $file"
    # Do something with $file
done

echo "All $count files processed!"
```

---

## Practice Exercises

### Exercise 1: Your First Shell Script

**Goal:** Create and run a simple shell script

**Steps:**
1. Create file: `notepad.exe hello.sh`
2. Type:
   ```bash
   #!/bin/bash
   echo "Hello from my first Git Bash shell script!"
   pwd
   ls -1
   ```
3. Save, make executable, and run:
   ```bash
   chmod +x hello.sh
   ./hello.sh
   ```

**Checkpoint:** You should see output for each command.

### Exercise 2: Script with a Variable

**Goal:** Use a variable to make the script flexible

**Steps:**
1. Create file: `notepad.exe smart-listing.sh`
2. Type:
   ```bash
   #!/bin/bash
   target_folder="$HOME/Documents"
   echo "Listing contents of: $target_folder"
   ls -1 "$target_folder"
   ```
3. Edit `target_folder` to a real folder on your computer
4. Run:
   ```bash
   chmod +x smart-listing.sh
   ./smart-listing.sh
   ```

**Checkpoint:** You should see listing of that specific folder.

### Exercise 3: Function

**Goal:** Create a reusable function

**Steps:**
1. Create file: `notepad.exe navigate.sh`
2. Type:
   ```bash
   #!/bin/bash
   go_to() {
       local path="$1"
       if [ -d "$path" ]; then
           cd "$path"
           echo "Now in: $(pwd)"
           echo "Contents:"
           ls -1
       else
           echo "Path does not exist: $path"
       fi
   }

   # Test the function:
   go_to "$HOME/Documents"
   go_to "$HOME/Downloads"
   ```
3. Run:
   ```bash
   chmod +x navigate.sh
   ./navigate.sh
   ```

**Checkpoint:** Both function calls should work, showing contents of each folder.

### Exercise 4: Loop

**Goal:** Use a loop to repeat an action

**Steps:**
1. Create file: `notepad.exe repeat.sh`
2. Type:
   ```bash
   #!/bin/bash
   echo "Demonstrating a loop:"

   for i in $(seq 1 5); do
       echo "Iteration $i: Hello!"
   done

   echo "Loop complete!"
   ```
3. Run:
   ```bash
   chmod +x repeat.sh
   ./repeat.sh
   ```

**Checkpoint:** Should print "Iteration 1" through "Iteration 5".

### Exercise 5: Real-World Script

**Goal:** Create a useful script for a real task

**Steps:**
1. Create a folder: `mkdir ~/Documents/TestFiles`
2. Create some test files:
   ```bash
   echo "test" > ~/Documents/TestFiles/file1.txt
   echo "test" > ~/Documents/TestFiles/file2.txt
   echo "test" > ~/Documents/TestFiles/file3.txt
   ```
3. Create script: `notepad.exe report.sh`
4. Type:
   ```bash
   #!/bin/bash
   folder="$HOME/Documents/TestFiles"
   count=0

   echo "=== FILE REPORT ==="
   echo "Folder: $folder"
   echo ""
   echo "Files:"
   for file in "$folder"/*; do
       echo "  - $(basename "$file")"
       count=$((count + 1))
   done
   echo ""
   echo "Total: $count files"
   echo "=== END REPORT ==="
   ```
5. Run:
   ```bash
   chmod +x report.sh
   ./report.sh
   ```

**Checkpoint:** Should show report of all files in the test folder.

---

## Quiz - Lesson GitBash.6

1. What is a shell script?
2. What file extension do bash shell scripts use?
3. What is a variable in bash and how do you create one?
4. What is a function and why would you use one?
5. How do you run a shell script?
6. What is a `for` loop and what does `for file in *.scad; do` do?
7. What does `[ -f "$file" ]` check?
8. How do you handle errors in a bash script?
9. When would you use `if [ ! -d "$path" ]; then`?
10. What technique makes shell script output readable for screen readers?

---

## Extension Problems

1. **Auto-Backup Script:** Create a bash script that copies all files from one folder to another, announcing progress
2. **File Counter:** Write a function that counts files by extension (.txt, .scad, .stl, etc.)
3. **Folder Cleaner:** Script that deletes files older than 30 days (with user confirmation)
4. **Project Template:** Function that creates a complete project folder structure with all needed files
5. **Batch Rename:** Script that renames all files in a folder according to a pattern
6. **Log Generator:** Create a script that records what it does to a log file for later review
7. **Scheduled Task:** Set up a script to run automatically using cron or Task Scheduler
8. **File Verifier:** Check that all SCAD files in a folder have corresponding STL exports
9. **Report Generator:** Create a summary report of all projects in a folder
10. **Error Tracker:** Script that lists all commands that had errors and logs them with timestamps

---

## Important Notes

- **Always test scripts on small sets of files first** before running them on important data
- **Save your work regularly** — use version naming if possible
- **Test error handling** — make sure errors don't crash silently
- **Document your scripts** — use `#` comments so you remember what each part does
- **Backup before batch operations** — if something goes wrong, you have the original

---

## References

- **GNU Bash Scripting Guide:** [https://example.com](https://example.com)
- **Function Documentation:** [https://example.com](https://example.com)
- **Error Handling:** [https://example.com](https://example.com)
- **Loops:** [https://example.com](https://example.com)
<!--pagebreak-->

