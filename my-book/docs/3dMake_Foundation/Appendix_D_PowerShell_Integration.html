
<!DOCTYPE HTML>
<html lang="en" class="latte sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Appendix F: PowerShell Integration for SCAD Workflows - 3D Printing Course for Blind and Visually Impaired Learners</title>


        <!-- Custom HTML head -->
        <script>
          (function(){
            // Load Atkinson Hyperlegible fonts from the book assets (injected at runtime so paths are correct on GitHub Pages)
            try {
              const link = Array.from(document.getElementsByTagName('link')).find(l => l.href && l.href.match(/\/css\/variables-.*\.css$/));
              const base = (function(){
                if (!link) return (window.location.origin||'') + '/';
                const u = new URL(link.href, window.location.href);
                const basePath = u.pathname.replace(/\/css\/.*$/,'');
                return u.origin + basePath + (basePath.endsWith('/') ? '' : '/');
              })();
        
              const css = `\
        @font-face {\
          font-family: 'Atkinson Hyperlegible Next';\
          src: url('${base}assets/fonts/AtkinsonHyperlegibleNext-Regular.ttf') format('truetype');\
          font-weight: 400; font-style: normal; font-display: swap;\
        }\
        @font-face {\
          font-family: 'Atkinson Hyperlegible Mono';\
          src: url('${base}assets/fonts/AtkinsonHyperlegibleMono-SemiBold.ttf') format('truetype');\
          font-weight: 600; font-style: normal; font-display: swap;\
        }\
        @font-face {\
          font-family: 'Atkinson Hyperlegible Mono';\
          src: url('${base}assets/fonts/AtkinsonHyperlegibleMono-Regular.otf') format('opentype');\
          font-weight: 400; font-style: normal; font-display: swap;\
        }\
        pre, code, .hljs, .leftbar { font-family: 'Atkinson Hyperlegible Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Segoe UI Mono", "Courier New", monospace !important; }\
        body { font-family: 'Atkinson Hyperlegible Next', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }\
        `;
        
              const style = document.createElement('style');
              style.appendChild(document.createTextNode(css));
              document.head.appendChild(style);
            } catch (e) { console.warn('Font injection failed', e); }
          })();
        </script>
        
        <script src="https://unpkg.com/mermaid@10/dist/mermaid.min.js"></script>
        <script>
          document.addEventListener("DOMContentLoaded", () => {
            mermaid.initialize({ startOnLoad: true });
          });
        </script>

        <meta name="description" content="An introduction to 3D printing for blind and visually impaired learners, using OpenSCAD and 3DMake to create accessible 3D models.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/catppuccin.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "latte";
            const default_dark_theme = "mocha";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('latte')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <!-- icon removed: fa helper unsupported -->
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <!-- icon removed: fa helper unsupported -->
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frappé</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <!-- icon removed: fa helper unsupported -->
                        </button>
                    </div>

                    <h1 class="menu-title">3D Printing Course for Blind and Visually Impaired Learners</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <!-- icon removed: fa helper unsupported -->
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <!-- icon removed: fa helper unsupported -->
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="3dmake_foundation-appendix_d_powershell_integration"><a class="header" href="#3dmake_foundation-appendix_d_powershell_integration">Appendix D: PowerShell Integration for SCAD Workflows</a></h1>
<p>This appendix shows how <strong>PowerShell (command-line scripting)</strong> streamlines 3D design workflows, automating the repetitive tasks from design through printing. It bridges <strong>PowerShell_Foundation concepts</strong> with <strong>3dMake_Foundation practical applications</strong>.</p>
<p><strong>Referenced in:</strong> Lessons 9 (Automation), 10 (Mastery), and any lesson requiring batch operations</p>
<p><strong>Prerequisites:</strong> Completion of PowerShell_Foundation (Lessons 1-6)</p>
<hr />
<h2 id="overview-why-automate-scad-workflows"><a class="header" href="#overview-why-automate-scad-workflows">Overview: Why Automate SCAD Workflows?</a></h2>
<h3 id="manual-workflow-time-consuming"><a class="header" href="#manual-workflow-time-consuming">Manual Workflow (Time-Consuming)</a></h3>
<pre><code>1. Open SCAD manually -&gt; Edit parameters -&gt; Save -&gt; Export STL
2. Open Slicer manually -&gt; Load STL -&gt; Adjust settings -&gt; Slice -&gt; Export G-code
3. Transfer G-code to printer via USB
4. Record results in notebook
5. Repeat for next variation (variant 2, variant 3, etc.)

Time: ~20-30 minutes per design iteration
</code></pre>
<h3 id="automated-workflow-fast--reproducible"><a class="header" href="#automated-workflow-fast--reproducible">Automated Workflow (Fast &amp; Reproducible)</a></h3>
<pre><code>1. Create PowerShell script with design parameters
2. Script automatically:
   - Generates SCAD code
   - Exports to STL
   - Slices to G-code
   - Transfers to printer
   - Logs results
3. Run script once, walk away
4. Check results later

Time: 2-3 minutes per iteration (plus print time)
</code></pre>
<h3 id="benefits-of-automation"><a class="header" href="#benefits-of-automation">Benefits of Automation</a></h3>
<ul>
<li>[YES] <strong>Speed:</strong> 10x faster for batch operations</li>
<li>[YES] <strong>Consistency:</strong> No manual errors</li>
<li>[YES] <strong>Reproducibility:</strong> Same settings every time</li>
<li>[YES] <strong>Scalability:</strong> Test 5, 10, or 100 variations easily</li>
<li>[YES] <strong>Logging:</strong> Automatic documentation</li>
<li>[YES] <strong>Accessibility:</strong> Screen reader captures script output (not UI clicks)</li>
</ul>
<hr />
<h2 id="prerequisites--setup"><a class="header" href="#prerequisites--setup">Prerequisites &amp; Setup</a></h2>
<h3 id="required-software"><a class="header" href="#required-software">Required Software</a></h3>
<pre><code class="language-powershell"># Check what you have installed
where openscad      # OpenSCAD
where prusa-slicer  # PrusaSlicer (or your slicer)
where python3       # Python (optional, for advanced scripts)
</code></pre>
<h3 id="directory-structure"><a class="header" href="#directory-structure">Directory Structure</a></h3>
<p>Create a project directory:</p>
<pre><code>C:\Projects\3dMake\
+------ src/
|   +------ bracelet_holder.scad
|   +------ phone_stand.scad
|   +------ stackable_bins.scad
+------ stl/
|   +------ bracelet_holder.stl
|   +------ phone_stand.stl
|   +------ stackable_bins.stl
+------ gcode/
|   +------ bracelet_holder.gcode
|   +------ phone_stand.gcode
|   +------ stackable_bins.gcode
+------ logs/
|   +------ batch_2024-01-15.log
|   +------ print_history.csv
+------ scripts/
    +------ build.ps1      (main build script)
    +------ batch_test.ps1 (test variations)
    +------ monitor.ps1    (monitor printer)
</code></pre>
<h3 id="powershell-execution-policy"><a class="header" href="#powershell-execution-policy">PowerShell Execution Policy</a></h3>
<pre><code class="language-powershell"># Check current policy
Get-ExecutionPolicy

# If it's "Restricted", change it (requires admin)
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# Verify change
Get-ExecutionPolicy
</code></pre>
<hr />
<h2 id="part-1-basic-workflow-automation"><a class="header" href="#part-1-basic-workflow-automation">Part 1: Basic Workflow Automation</a></h2>
<h3 id="script-1-single-file-build"><a class="header" href="#script-1-single-file-build">Script 1: Single-File Build</a></h3>
<p>This script takes a SCAD file and converts it through the entire workflow:</p>
<pre><code class="language-powershell"># build.ps1 - Convert SCAD -&gt; STL -&gt; G-code

param(
    [string]$ScadFile,          # Input: bracelet_holder.scad
    [string]$OutputDir = ".\",  # Output directory
    [string]$SlicerConfig = "default"
)

# Set up paths
$ProjectRoot = "C:\Projects\3dMake"
$ScadFile = Join-Path $ProjectRoot "src" $ScadFile
$StlFile = Join-Path $ProjectRoot "stl" ([System.IO.Path]::GetFileNameWithoutExtension($ScadFile) + ".stl")
$GcodeFile = Join-Path $ProjectRoot "gcode" ([System.IO.Path]::GetFileNameWithoutExtension($ScadFile) + ".gcode")
$LogFile = Join-Path $ProjectRoot "logs" "build_$(Get-Date -Format 'yyyy-MM-dd').log"

# Log function
function Write-Log {
    param([string]$Message)
    $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
    $logEntry = "[$timestamp] $Message"
    Write-Host $logEntry
    Add-Content -Path $LogFile -Value $logEntry
}

Write-Log "Starting build for $($ScadFile | Split-Path -Leaf)"

# Step 1: Export STL
Write-Log "Step 1: Exporting SCAD to STL..."
$startTime = Get-Date

&amp; "C:\Program Files\OpenSCAD\openscad.exe" `
    -o "$StlFile" `
    "$ScadFile"

$duration = (Get-Date) - $startTime
Write-Log " STL exported in $($duration.TotalSeconds) seconds: $StlFile"

# Verify STL exists
if (-not (Test-Path $StlFile)) {
    Write-Log "[NO] ERROR: STL file not created"
    exit 1
}

# Step 2: Slice to G-code
Write-Log "Step 2: Slicing STL to G-code..."
$startTime = Get-Date

&amp; "C:\Program Files\Prusa3D\PrusaSlicer\prusa-slicer.exe" `
    --load-config-file "$SlicerConfig" `
    --export-gcode "$GcodeFile" `
    "$StlFile"

$duration = (Get-Date) - $startTime
Write-Log " G-code generated in $($duration.TotalSeconds) seconds: $GcodeFile"

# Verify G-code exists
if (-not (Test-Path $GcodeFile)) {
    Write-Log "[NO] ERROR: G-code file not created"
    exit 1
}

# Step 3: Get file info
$stlSize = (Get-Item $StlFile).Length / 1MB
$gcodeSize = (Get-Item $GcodeFile).Length / 1MB
Write-Log "File sizes: STL=$([math]::Round($stlSize, 2))MB, G-code=$([math]::Round($gcodeSize, 2))MB"

Write-Log " BUILD COMPLETE"
Write-Log "Ready to print: $GcodeFile"
</code></pre>
<p><strong>Usage:</strong></p>
<pre><code class="language-powershell"># Run the script
.\build.ps1 -ScadFile "bracelet_holder.scad"

# Output example:
# [2024-01-15 14:30:22] Starting build for bracelet_holder.scad
# [2024-01-15 14:30:23] Step 1: Exporting SCAD to STL...
# [2024-01-15 14:30:25]  STL exported in 2.41 seconds: ...
# [2024-01-15 14:30:26] Step 2: Slicing STL to G-code...
# [2024-01-15 14:30:28]  G-code generated in 2.31 seconds: ...
# [2024-01-15 14:30:28]  BUILD COMPLETE
</code></pre>
<h3 id="script-2-batch-build-multiple-files"><a class="header" href="#script-2-batch-build-multiple-files">Script 2: Batch Build (Multiple Files)</a></h3>
<pre><code class="language-powershell"># batch_build.ps1 - Build all SCAD files in a directory

param(
    [string]$SourceDir = "C:\Projects\3dMake\src",
    [string]$SlicerConfig = "default"
)

$ProjectRoot = Split-Path $SourceDir
$buildScript = Join-Path $ProjectRoot "scripts" "build.ps1"

# Find all SCAD files
$scadFiles = Get-ChildItem -Path $SourceDir -Filter "*.scad" -Recurse

Write-Host "Found $($scadFiles.Count) SCAD files"

if ($scadFiles.Count -eq 0) {
    Write-Host "No SCAD files found in $SourceDir"
    exit 1
}

# Process each file
$results = @()
foreach ($file in $scadFiles) {
    Write-Host "`n--- Processing: $($file.Name) ---"
    
    $startTime = Get-Date
    
    # Run build script for this file
    &amp; $buildScript -ScadFile $file.Name -SlicerConfig $SlicerConfig
    
    $duration = (Get-Date) - $startTime
    
    $results += [PSCustomObject]@{
        FileName = $file.Name
        DurationSeconds = $duration.TotalSeconds
        Status = "Success"
        Timestamp = Get-Date
    }
}

# Summary report
Write-Host "`n=== BATCH BUILD SUMMARY ==="
Write-Host "Files processed: $($results.Count)"
Write-Host "Total time: $([math]::Round(($results | Measure-Object -Property DurationSeconds -Sum).Sum, 1)) seconds"

# Save results to CSV
$csvPath = Join-Path $ProjectRoot "logs" "batch_$(Get-Date -Format 'yyyy-MM-dd-HHmmss').csv"
$results | Export-Csv -Path $csvPath -NoTypeInformation
Write-Host "Results saved: $csvPath"
</code></pre>
<p><strong>Usage:</strong></p>
<pre><code class="language-powershell">.\batch_build.ps1 -SourceDir "C:\Projects\3dMake\src"

# Processes all .scad files automatically
</code></pre>
<hr />
<h2 id="part-2-parametric-design-variation-testing"><a class="header" href="#part-2-parametric-design-variation-testing">Part 2: Parametric Design Variation Testing</a></h2>
<h3 id="the-problem-testing-multiple-parameter-values"><a class="header" href="#the-problem-testing-multiple-parameter-values">The Problem: Testing Multiple Parameter Values</a></h3>
<p>You want to test the same design with different parameters (e.g., peg diameter: 5mm, 6mm, 7mm):</p>
<pre><code>Manually:
1. Open bracelet_holder.scad
2. Change peg_diameter = 5
3. Save, export, slice, print
4. Change peg_diameter = 6
5. Save, export, slice, print
6. Change peg_diameter = 7
7. Save, export, slice, print
Time: 30 minutes
</code></pre>
<h3 id="automated-solution-parametric-sweep"><a class="header" href="#automated-solution-parametric-sweep">Automated Solution: Parametric Sweep</a></h3>
<pre><code class="language-powershell"># parametric_sweep.ps1 - Test multiple parameter values

param(
    [string]$TemplateScad = "C:\Projects\3dMake\src\bracelet_holder.scad",
    [hashtable]$ParameterRanges = @{
        "peg_diameter" = @(5, 5.5, 6, 6.5, 7)
        "holder_width" = @(120, 127, 135)
    }
)

$ProjectRoot = "C:\Projects\3dMake"
$variantsDir = Join-Path $ProjectRoot "variants"
$buildScript = Join-Path $ProjectRoot "scripts" "build.ps1"
$logFile = Join-Path $ProjectRoot "logs" "parametric_sweep_$(Get-Date -Format 'yyyy-MM-dd-HHmmss').csv"

# Create variants directory
New-Item -ItemType Directory -Path $variantsDir -Force | Out-Null

# Read template
$template = Get-Content $TemplateScad -Raw

# Generate variants
$results = @()
$variantNum = 0

# For each diameter value
foreach ($dia in $ParameterRanges["peg_diameter"]) {
    
    # For each width value
    foreach ($width in $ParameterRanges["holder_width"]) {
        
        $variantNum++
        $variantName = "variant_dia${dia}_width${width}"
        $variantScad = Join-Path $variantsDir "$variantName.scad"
        
        # Create variant SCAD file with parameters
        $content = $template `
            -replace 'peg_diameter = [\d.]+', "peg_diameter = $dia" `
            -replace 'holder_width = [\d.]+', "holder_width = $width"
        
        $content | Set-Content $variantScad
        
        Write-Host "Generated: $variantName"
        
        # Build variant (STL + G-code)
        $startTime = Get-Date
        
        # Export to STL
        &amp; "C:\Program Files\OpenSCAD\openscad.exe" `
            -o (Join-Path $ProjectRoot "stl" "$variantName.stl") `
            $variantScad
        
        $duration = (Get-Date) - $startTime
        
        # Record result
        $results += [PSCustomObject]@{
            Variant = $variantName
            PegDiameter = $dia
            HolderWidth = $width
            BuildTimeSeconds = $duration.TotalSeconds
            Status = "Success"
            Timestamp = Get-Date
        }
        
        Write-Host "   Built in $($duration.TotalSeconds) seconds"
    }
}

# Save results
$results | Export-Csv -Path $logFile -NoTypeInformation
Write-Host "`nParametric sweep complete: $($results.Count) variants generated"
Write-Host "Results: $logFile"

# Summary statistics
Write-Host "`n=== PARAMETER RANGES TESTED ==="
Write-Host "Peg diameters: $($ParameterRanges['peg_diameter'] -join ', ')"
Write-Host "Holder widths: $($ParameterRanges['holder_width'] -join ', ')"
Write-Host "Total combinations: $($results.Count)"
</code></pre>
<p><strong>Usage:</strong></p>
<pre><code class="language-powershell">$ranges = @{
    "peg_diameter" = @(5, 5.5, 6, 6.5, 7)
    "holder_width" = @(120, 127, 135)
}

.\parametric_sweep.ps1 -TemplateScad "bracelet_holder.scad" -ParameterRanges $ranges

# Generates 15 variants automatically (5 x 3)
</code></pre>
<p><strong>Output CSV:</strong></p>
<pre><code>Variant,PegDiameter,HolderWidth,BuildTimeSeconds,Status,Timestamp
variant_dia5_width120,5,120,2.4,Success,2024-01-15 14:35:22
variant_dia5_width127,5,127,2.5,Success,2024-01-15 14:35:25
variant_dia5_width135,5,135,2.3,Success,2024-01-15 14:35:28
...
</code></pre>
<hr />
<h2 id="part-3-automated-print-documentation"><a class="header" href="#part-3-automated-print-documentation">Part 3: Automated Print Documentation</a></h2>
<h3 id="script-print-logging--quality-tracking"><a class="header" href="#script-print-logging--quality-tracking">Script: Print Logging &amp; Quality Tracking</a></h3>
<pre><code class="language-powershell"># log_print.ps1 - Document each print with metadata

param(
    [string]$GcodeFile,
    [string]$ProjectName,
    [string]$Material = "PLA",
    [string]$Notes = ""
)

$ProjectRoot = "C:\Projects\3dMake"
$printLogCsv = Join-Path $ProjectRoot "logs" "print_history.csv"

# Get G-code file info
$gcodeInfo = Get-Item $GcodeFile
$gcodeSize = $gcodeInfo.Length / 1MB
$estimatedTime = EstimateTime $GcodeFile  # See function below

# Calculate estimated cost
$weightG = EstimateWeight $GcodeFile
$materialCostPerKg = 20  # PLA at $20/kg
$estimatedCost = ($weightG / 1000) * $materialCostPerKg

# Create log entry
$entry = [PSCustomObject]@{
    PrintID = "PRINT_$(Get-Date -Format 'yyyyMMdd_HHmmss')"
    ProjectName = $ProjectName
    Date = Get-Date
    Material = $Material
    GcodeFile = $gcodeFile
    GcodeSizeMB = [math]::Round($gcodeSize, 2)
    EstimatedTimeHours = [math]::Round($estimatedTime / 3600, 2)
    EstimatedWeightG = [math]::Round($weightG, 1)
    EstimatedCostUSD = [math]::Round($estimatedCost, 2)
    Notes = $Notes
}

# Append to CSV
if (Test-Path $printLogCsv) {
    $entry | Export-Csv -Path $printLogCsv -NoTypeInformation -Append
} else {
    $entry | Export-Csv -Path $printLogCsv -NoTypeInformation
}

Write-Host "Print logged:"
Write-Host "  Project: $ProjectName"
Write-Host "  File: $($gcodeInfo.Name)"
Write-Host "  Estimated time: $([math]::Round($estimatedTime / 3600, 2)) hours"
Write-Host "  Estimated weight: $([math]::Round($weightG, 1))g"
Write-Host "  Estimated cost: $$([math]::Round($estimatedCost, 2))"

# Function to estimate print time from G-code (simplified)
function EstimateTime {
    param([string]$GcodeFile)
    
    $lines = @(Get-Content $GcodeFile | Select-String "^G1" | Measure-Object).Count
    # Rough estimate: 10 lines per second
    return $lines / 10
}

# Function to estimate weight from G-code (simplified)
function EstimateWeight {
    param([string]$GcodeFile)
    
    # G-code filament estimate (if supported by your slicer)
    $content = Get-Content $GcodeFile -Raw
    
    if ($content -match "filament used = ([\d.]+)") {
        return [double]$matches[1]
    } else {
        return 0  # Fallback
    }
}
</code></pre>
<p><strong>Usage:</strong></p>
<pre><code class="language-powershell">.\log_print.ps1 `
    -GcodeFile "C:\Projects\3dMake\gcode\bracelet_holder.gcode" `
    -ProjectName "Bracelet Holder" `
    -Material "PLA" `
    -Notes "Final design, tested with actual bracelets"
</code></pre>
<hr />
<h2 id="part-4-printer-communication--monitoring"><a class="header" href="#part-4-printer-communication--monitoring">Part 4: Printer Communication &amp; Monitoring</a></h2>
<h3 id="script-send-g-code-to-printer-usb"><a class="header" href="#script-send-g-code-to-printer-usb">Script: Send G-code to Printer (USB)</a></h3>
<pre><code class="language-powershell"># send_to_printer.ps1 - Copy G-code to printer USB

param(
    [string]$GcodeFile,
    [string]$PrinterUSBLetter = "E"  # E:, F:, G:, etc.
)

$printerDrive = "${PrinterUSBLetter}:\"

# Check if USB drive connected
if (-not (Test-Path $printerDrive)) {
    Write-Host "[NO] ERROR: Printer USB not found at $PrinterUSBLetter"
    Write-Host "Available drives:"
    Get-PSDrive -PSProvider FileSystem | Where-Object Name -Like "[D-Z]" | Select-Object Name
    exit 1
}

# Copy file
$filename = Split-Path $GcodeFile -Leaf
$destination = Join-Path $printerDrive $filename

Copy-Item -Path $GcodeFile -Destination $destination -Force

Write-Host " G-code copied to printer USB:"
Write-Host "  From: $GcodeFile"
Write-Host "  To: $destination"
Write-Host "`nNext steps:"
Write-Host "  1. Eject USB safely from computer"
Write-Host "  2. Insert USB into printer"
Write-Host "  3. Select file on printer screen"
Write-Host "  4. Press print"
</code></pre>
<p><strong>Usage:</strong></p>
<pre><code class="language-powershell">.\send_to_printer.ps1 -GcodeFile "C:\Projects\3dMake\gcode\bracelet_holder.gcode" -PrinterUSBLetter "E"
</code></pre>
<h3 id="script-monitor-printer-status-network-printers"><a class="header" href="#script-monitor-printer-status-network-printers">Script: Monitor Printer Status (Network Printers)</a></h3>
<pre><code class="language-powershell"># monitor_printer.ps1 - Check printer status via API

param(
    [string]$PrinterIP,
    [int]$CheckInterval = 30,    # seconds
    [int]$MaxChecks = 240        # 2 hours max
)

$printerUrl = "http://$PrinterIP:8080/api/printer"
$checksPerformed = 0

Write-Host "Monitoring printer at $PrinterIP"
Write-Host "Check interval: $CheckInterval seconds"
Write-Host "Ctrl+C to stop`n"

while ($checksPerformed -lt $MaxChecks) {
    try {
        # Get printer status
        $response = Invoke-WebRequest -Uri $printerUrl -UseBasicParsing -ErrorAction Stop
        $status = $response.Content | ConvertFrom-Json
        
        $state = $status.state.text
        $progress = $status.progress.completion
        $timeRemaining = $status.progress.printTimeLeft
        
        Write-Host "[$((Get-Date).ToString("HH:mm:ss"))] State: $state | Progress: $progress% | Time remaining: $timeRemaining seconds"
        
        # If print completed, exit loop
        if ($state -eq "Operational") {
            Write-Host "`n Print complete!"
            break
        }
        
    } catch {
        Write-Host "Connection error: $_"
    }
    
    Start-Sleep -Seconds $CheckInterval
    $checksPerformed++
}

if ($checksPerformed -ge $MaxChecks) {
    Write-Host "Max monitoring time reached. Stopping."
}
</code></pre>
<p><strong>Usage:</strong></p>
<pre><code class="language-powershell">.\monitor_printer.ps1 -PrinterIP "192.168.1.100" -CheckInterval 30
</code></pre>
<hr />
<h2 id="part-5-complete-workflow-integration"><a class="header" href="#part-5-complete-workflow-integration">Part 5: Complete Workflow Integration</a></h2>
<h3 id="master-script-design---print---log"><a class="header" href="#master-script-design---print---log">Master Script: Design -&gt; Print -&gt; Log</a></h3>
<pre><code class="language-powershell"># full_workflow.ps1 - Complete automation from design to printing

param(
    [string]$ProjectName,
    [string]$ScadFile,
    [string]$Material = "PLA",
    [string]$Notes = "",
    [switch]$SendToPrinter,
    [string]$PrinterUSBLetter = "E"
)

$ProjectRoot = "C:\Projects\3dMake"

Write-Host "=== 3dMake Full Workflow Automation ==="
Write-Host "Project: $ProjectName"
Write-Host ""

# Step 1: Build (SCAD -&gt; STL -&gt; G-code)
Write-Host "Step 1: Building..."
&amp; "$ProjectRoot\scripts\build.ps1" -ScadFile $ScadFile
if ($LASTEXITCODE -ne 0) { exit 1 }

# Step 2: Log the print
Write-Host "`nStep 2: Logging print metadata..."
$gcodeFile = Join-Path $ProjectRoot "gcode" ([System.IO.Path]::GetFileNameWithoutExtension($ScadFile) + ".gcode")
&amp; "$ProjectRoot\scripts\log_print.ps1" `
    -GcodeFile $gcodeFile `
    -ProjectName $ProjectName `
    -Material $Material `
    -Notes $Notes

# Step 3: Send to printer (optional)
if ($SendToPrinter) {
    Write-Host "`nStep 3: Sending to printer..."
    &amp; "$ProjectRoot\scripts\send_to_printer.ps1" `
        -GcodeFile $gcodeFile `
        -PrinterUSBLetter $PrinterUSBLetter
}

Write-Host "`n Workflow complete!"
</code></pre>
<p><strong>Usage:</strong></p>
<pre><code class="language-powershell"># Full workflow with automatic printer transfer
.\full_workflow.ps1 `
    -ProjectName "Bracelet Holder" `
    -ScadFile "bracelet_holder.scad" `
    -Material "PLA" `
    -Notes "Final design, v2 with improved peg strength" `
    -SendToPrinter `
    -PrinterUSBLetter "E"
</code></pre>
<hr />
<h2 id="part-6-powershell-skills-applied-to-scad"><a class="header" href="#part-6-powershell-skills-applied-to-scad">Part 6: PowerShell Skills Applied to SCAD</a></h2>
<h3 id="lesson-mapping-powershell---scad-workflows"><a class="header" href="#lesson-mapping-powershell---scad-workflows">Lesson Mapping: PowerShell -&gt; SCAD Workflows</a></h3>
<div class="table-wrapper"><table><thead><tr><th>PowerShell Lesson</th><th>SCAD Application</th><th>Example</th></tr></thead><tbody>
<tr><td><strong>PS 1: Navigation</strong></td><td>Working with project directories</td><td>Using <code>cd</code> to navigate src/ -&gt; stl/ -&gt; gcode/</td></tr>
<tr><td><strong>PS 2: File Manipulation</strong></td><td>Copying, organizing SCAD files</td><td>Copy design files, organize variants by date</td></tr>
<tr><td><strong>PS 3: Piping &amp; Objects</strong></td><td>Pass data between scripts</td><td><code>$results | Export-Csv</code> exports analysis</td></tr>
<tr><td><strong>PS 4: Variables &amp; Aliases</strong></td><td>Parameterize SCAD workflows</td><td>Variables store file paths, material types, etc.</td></tr>
<tr><td><strong>PS 5: Functions &amp; Modules</strong></td><td>Reusable automation blocks</td><td>Build, slice, log = functions in one script</td></tr>
<tr><td><strong>PS Unit Test</strong></td><td>Verify workflow correctness</td><td>Test that STL file exists before slicing</td></tr>
</tbody></table>
</div>
<h3 id="example-file-navigation-with-scad-projects"><a class="header" href="#example-file-navigation-with-scad-projects">Example: File Navigation with SCAD Projects</a></h3>
<pre><code class="language-powershell"># Navigate between SCAD project folders
$ProjectRoot = "C:\Projects\3dMake"

# Go to source directory
cd "$ProjectRoot\src"
Get-ChildItem -Filter "*.scad"  # List all SCAD files

# Process each file
foreach ($file in Get-ChildItem -Filter "*.scad") {
    Write-Host "Processing: $($file.Name)"
    # Do something with each file
}

# Go to output directory and check results
cd "$ProjectRoot\stl"
Get-ChildItem -Filter "*.stl" | Measure-Object -Sum
</code></pre>
<h3 id="example-working-with-piping--objects"><a class="header" href="#example-working-with-piping--objects">Example: Working with Piping &amp; Objects</a></h3>
<pre><code class="language-powershell"># Build all files, then get statistics

Get-ChildItem -Path "$ProjectRoot\src" -Filter "*.scad" |
    ForEach-Object {
        # Build each one
        &amp; .\build.ps1 -ScadFile $_.Name
    } |
    # Analyze results
    Group-Object -Property Status |
    Select-Object Name, Count
</code></pre>
<hr />
<h2 id="accessibility-considerations"><a class="header" href="#accessibility-considerations">Accessibility Considerations</a></h2>
<h3 id="why-powershell-for-scad"><a class="header" href="#why-powershell-for-scad">Why PowerShell for SCAD?</a></h3>
<ol>
<li><strong>Screen Reader Friendly:</strong> Console output = text (not UI clicks)</li>
<li><strong>Scriptable:</strong> Can run overnight, results logged</li>
<li><strong>Auditable:</strong> Every step written to log file</li>
<li><strong>Shareable:</strong> Scripts document the process for others</li>
<li><strong>Testable:</strong> Can verify each step independently</li>
</ol>
<h3 id="example-accessible-build-output"><a class="header" href="#example-accessible-build-output">Example: Accessible Build Output</a></h3>
<pre><code>[2024-01-15 14:30:22] Starting build for bracelet_holder.scad
[2024-01-15 14:30:23] Step 1: Exporting SCAD to STL...
[2024-01-15 14:30:25]  STL exported in 2.41 seconds
[2024-01-15 14:30:26] Step 2: Slicing STL to G-code...
[2024-01-15 14:30:28]  G-code generated in 2.31 seconds
[2024-01-15 14:30:28] File sizes: STL=2.15MB, G-code=4.32MB
[2024-01-15 14:30:28]  BUILD COMPLETE

Ready to print: C:\Projects\3dMake\gcode\bracelet_holder.gcode
</code></pre>
<p>All information is <strong>text-based and sequential</strong>-perfectly accessible to screen readers.</p>
<hr />
<h2 id="best-practices--tips"><a class="header" href="#best-practices--tips">Best Practices &amp; Tips</a></h2>
<h3 id="1-always-log-everything"><a class="header" href="#1-always-log-everything">1. Always Log Everything</a></h3>
<pre><code class="language-powershell">function Write-Log {
    param(
        [string]$Message,
        [string]$LogFile
    )
    
    $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
    $entry = "[$timestamp] $Message"
    Write-Host $entry
    Add-Content -Path $LogFile -Value $entry
}
</code></pre>
<h3 id="2-verify-steps-succeed-before-continuing"><a class="header" href="#2-verify-steps-succeed-before-continuing">2. Verify Steps Succeed Before Continuing</a></h3>
<pre><code class="language-powershell"># Don't just run commands-check they worked
&amp; "C:\Program Files\OpenSCAD\openscad.exe" -o "$StlFile" "$ScadFile"

if (-not (Test-Path $StlFile)) {
    Write-Log "ERROR: STL creation failed"
    exit 1
}

Write-Log " STL created successfully"
</code></pre>
<h3 id="3-make-scripts-reusable"><a class="header" href="#3-make-scripts-reusable">3. Make Scripts Reusable</a></h3>
<pre><code class="language-powershell"># BAD: Hardcoded paths
$scadFile = "C:\Users\John\Desktop\bracelet_holder.scad"

# GOOD: Parameters with defaults
param(
    [string]$ScadFile = "bracelet_holder.scad",
    [string]$ProjectRoot = "C:\Projects\3dMake"
)

$fullPath = Join-Path $ProjectRoot "src" $ScadFile
</code></pre>
<h3 id="4-use-configuration-files"><a class="header" href="#4-use-configuration-files">4. Use Configuration Files</a></h3>
<pre><code class="language-powershell"># config.ps1 - Centralized settings
$Config = @{
    ProjectRoot = "C:\Projects\3dMake"
    OpenSCADPath = "C:\Program Files\OpenSCAD\openscad.exe"
    SlicerPath = "C:\Program Files\Prusa3D\PrusaSlicer\prusa-slicer.exe"
    PrinterUSB = "E"
    DefaultMaterial = "PLA"
    DefaultInfill = 20
}

# Use in scripts:
# . .\config.ps1
# &amp; $Config.OpenSCADPath ...
</code></pre>
<hr />
<h2 id="troubleshooting-automated-workflows"><a class="header" href="#troubleshooting-automated-workflows">Troubleshooting Automated Workflows</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Problem</th><th>Cause</th><th>Solution</th></tr></thead><tbody>
<tr><td>Scripts won't run</td><td>Execution policy</td><td><code>Set-ExecutionPolicy -ExecutionPolicy RemoteSigned</code></td></tr>
<tr><td>Command not found</td><td>Tool not in PATH</td><td>Specify full path: <code>&amp; "C:\Program Files\OpenSCAD\openscad.exe"</code></td></tr>
<tr><td>Files not created</td><td>Wrong working directory</td><td>Use absolute paths with <code>Join-Path</code></td></tr>
<tr><td>Script hangs</td><td>Waiting for user input</td><td>Disable UI input; use <code>-o</code> flag for batch operations</td></tr>
<tr><td>CSV data corrupted</td><td>Special characters in notes</td><td>Properly quote strings in CSV export</td></tr>
<tr><td>No output/logging</td><td>Path doesn't exist</td><td>Create directory first: <code>New-Item -Type Directory -Path ... -Force</code></td></tr>
</tbody></table>
</div>
<hr />
<h2 id="summary-powershell--scad-integration-benefits"><a class="header" href="#summary-powershell--scad-integration-benefits">Summary: PowerShell + SCAD Integration Benefits</a></h2>
<h3 id="time-savings"><a class="header" href="#time-savings">Time Savings</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Task</th><th>Manual</th><th>Automated</th><th>Savings</th></tr></thead><tbody>
<tr><td>Single design build</td><td>5 min</td><td>2.5 min</td><td>50%</td></tr>
<tr><td>Test 10 parameter variations</td><td>50 min</td><td>5 min</td><td>90%</td></tr>
<tr><td>Batch processing 20 designs</td><td>100 min</td><td>10 min</td><td>90%</td></tr>
</tbody></table>
</div>
<h3 id="consistency"><a class="header" href="#consistency">Consistency</a></h3>
<ul>
<li>[YES] Same process every time (no missed steps)</li>
<li>[YES] Reproducible results (exact same settings)</li>
<li>[YES] Comprehensive logging (documentation automatic)</li>
</ul>
<h3 id="scalability"><a class="header" href="#scalability">Scalability</a></h3>
<ul>
<li>[YES] 1 design or 1,000 designs = same time commitment</li>
<li>[YES] Run overnight for batch operations</li>
<li>[YES] Easy to expand with new features</li>
</ul>
<h3 id="accessibility"><a class="header" href="#accessibility">Accessibility</a></h3>
<ul>
<li>[YES] All interaction is text-based (screen reader friendly)</li>
<li>[YES] Results logged in CSV (machine-readable, sortable)</li>
<li>[YES] Repeatable (can verify steps later)</li>
</ul>
<hr />
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<ol>
<li><strong>Try the basic build script</strong> (Script 1) with one of your SCAD files</li>
<li><strong>Add logging</strong> (Script 3) to track what you create</li>
<li><strong>Test parametric sweeps</strong> (Script 2) with design variations</li>
<li><strong>Integrate full workflow</strong> (Script 5) for complete automation</li>
<li><strong>Customize config.ps1</strong> for your specific setup</li>
</ol>
<p><strong>Remember:</strong> Start simple, test each script individually, then combine them into larger workflows. PowerShell is most powerful when built incrementally!</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- templates for fa icons removed: fa helper unsupported -->



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
